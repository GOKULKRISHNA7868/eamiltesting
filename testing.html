<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Email API Tester</title>
</head>
<body>
  <h2>üì® Test External Email Sender</h2>

  <form id="emailForm">
    <input type="email" id="to" placeholder="Recipient Email" required /><br><br>
    <input type="text" id="subject" placeholder="Email Subject" required /><br><br>
    <textarea id="message" placeholder="Enter email message" rows="6" cols="40" required></textarea><br><br>
    <button type="submit">Send Email</button>
  </form>

  <p id="result"></p>

  <script>
    const form = document.getElementById("emailForm");
    const result = document.getElementById("result");

    form.addEventListener("submit", async (e) => {
      e.preventDefault();

      const to = document.getElementById("to").value;
      const subject = document.getElementById("subject").value;
      const message = document.getElementById("message").value;

      try {
        const res = await fetch("https://tasbackend-i51elqur4-t-gokul-krishnas-projects.vercel.app/api/send-email", {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify({
            to,
            subject,
            html: `<p>${message}</p>`,
            text: message, // fallback text version
          }),
        });

        const data = await res.json();
        if (res.ok) {
          result.textContent = "‚úÖ Email sent: " + data.message;
          result.style.color = "green";
        } else {
          result.textContent = "‚ùå Error: " + (data.error || "Unknown error");
          result.style.color = "red";
        }
      } catch (err) {
        result.textContent = "‚ùå Failed to fetch: " + err.message;
        result.style.color = "red";
      }
    });
  </script>
</body>
</html>
